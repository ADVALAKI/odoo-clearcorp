<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>
    
		<!-- views -->
		<!-- ccorp.project.oerp.work.type -->
		<!-- form -->
		 <record id="view_work_type_form" model="ir.ui.view">
			<field name="name">view.worktype.form</field>
			<field name="model">ccorp.project.oerp.work.type</field>
			<field name="type">form</field>
            <field name="priority" eval="16" />
			<field name="arch" type="xml">
			<form>
			<group>
			  <group>
			  <field name="name"/>
			  <field name="product_id"/>
			  </group><group>
			  <field name="sequence" />
			  <field name="column_number" />
			  </group>
			  </group>
			  </form>
			</field>
		</record>
        
        <record id="view_work_type_tree" model="ir.ui.view">
            <field name="name">view.worktype.form</field>
            <field name="model">ccorp.project.oerp.work.type</field>
            <field name="priority" eval="16" />
            <field name="arch" type="xml">
                <tree string="Work Type Task">
                    <field name="name"/>
                    <field name="product_id"/>
                </tree>
            </field>
        </record>

		<!-- ccorp.project.scrum.feature -->
		<!-- form -->
		<record id="view_feature_form" model="ir.ui.view">
			<field name="name">view.feature.form</field>
			<field name="model">project.scrum.feature</field>
			<field name="inherit_id" ref="project_scrum_method.view_feature_form" />
			<field name="arch" type="xml">
				<xpath expr="//form/sheet/group/group/field[@name='expected_hours']"
					position="attributes">
					<attribute name="readonly">True</attribute>
					<attribute name="required">False</attribute>
				</xpath>
				<xpath expr="//form/sheet/group/group/field[@name='progress']"
                    position="after">
                        <field name="validation_date"/>
                 </xpath>
				<xpath expr="//form/sheet/notebook/page[@name='description']"
					position="after">
					<page string="Feature Hours" name="d">
						<field name="id" invisible="True" />
						<field name="hour_ids" attrs="{'readonly':[('state','=','approved')]}">
							<tree editable="bottom">
								<field name="work_type_id" />
								<field name="expected_hours" sum="Total Planned" />
								<field name="effective_hours" sum="Total Spent" />
								<field name="remaining_hours" sum="Total Remaining" />
							</tree>
						</field>
					</page>
				</xpath>
			</field>
		</record>

		<!-- project.task -->
		<!-- form -->
		<record id="view_task_form" model="ir.ui.view">
			<field name="name">view.task.form</field>
			<field name="model">project.task</field>
			<field name="inherit_id" ref="project.view_task_form2" />
			<field name="priority" eval="100" />
			<field name="arch" type="xml">
				<xpath expr="//form/sheet/notebook/page[@name='sequence']"
					position="before">
					<page string="Feature Hours" name="feature_hours"
                        attrs="{'invisible': [('feature_id','=',False)]}">
						<field name="feature_hour_ids">
							<tree>
								<field name="work_type_id" />
								<field name="expected_hours" sum="Planned Hour(s)" />
								<field name="effective_hours" sum="Spent Hour(s)" />
								<field name="remaining_hours" sum="Remaining Hour(s)" />
							</tree>
						</field>
					</page>
				</xpath>			
			</field>
		</record>
        
        <record id="view_task_form_user" model="ir.ui.view">
            <field name="name">view.task.form</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="project.view_task_form2" />
            <field name="priority" eval="50" />
            <field name="arch" type="xml">
                <xpath expr="//form/sheet/group/group/field[@name='planned_hours']"
                        position="attributes">
                        <attribute name="readonly">True</attribute>
                </xpath>
              </field>
        </record>
        
        <record id="view_task_form_teammanager" model="ir.ui.view">
            <field name="name">view.task.form</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="project.view_task_form2" />
            <field name="priority" eval="100" />
            <field name="groups_id" eval="[(4, ref('project.group_project_team_manager'))]"/>
            <field name="arch" type="xml">
                <xpath expr="//form/sheet/group/group/field[@name='planned_hours']"
                        position="attributes">
                        <attribute name="readonly">False</attribute>
                        <attribute name="attrs">{'readonly': [('state','!=','draft')]}</attribute>
                </xpath>
              </field>
        </record>

		<!-- ccorp.project.scrum.sprint -->
		<!-- form -->
		<record id="view_sprint_form" model="ir.ui.view">
			<field name="name">view.sprint.form</field>
			<field name="model">project.scrum.sprint</field>
			<field name="inherit_id" ref="project_scrum_method.view_sprint_form" />
			<field name="arch" type="xml">
				<xpath expr="//form/sheet/notebook/page[@name='tasks']"
					position="after">
					<page string="Planned Tasks" name="desirable_tasks" attrs="{'invisible': [('state','=', 'new')]}">
						<field name="planned_task_ids" attrs="{'invisible': [('state','=', 'new')]}"/>
					</page>
				</xpath>
			</field>
		</record>
        
          
        

        <!-- actions -->
        <!-- ccorp.project.oerp.feature.import.wizard -->
        <record model="ir.actions.act_window" id="action_feature_import_wizard">
            <field name="name">Feature Import</field>
            <field name="res_model">ccorp.project.oerp.feature.import.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>
        
        <!-- ccorp.project.oerp.sprint.close.wizard -->
        <record model="ir.actions.act_window" id="action_sprint_close_wizard">
            <field name="name">Close Sprint</field>
            <field name="res_model">ccorp.project.oerp.sprint.close.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>
        
       
        
        <record id="action_work_type" model="ir.actions.act_window">
            <field name="name">Work Types</field>
            <field name="res_model">project.work.type</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>
        
        <!-- Server actions -->
       <record id="action_create_tasks" model="ir.actions.server">
           <field name="name">Generate Tasks</field>
           <field name="model_id" ref="model_project_scrum_feature"/>
                <field name="code">
                    self.create_tasks(cr, uid, context)
                </field>
       </record>
       
         <record model="ir.values" id="menu_create_tasks">
            <field name="key2">client_action_multi</field>
            <field name="model">project.scrum.feature</field>
            <field name="name">Generate Tasks</field>
            <field name="value" eval="'ir.actions.server,%d'%action_create_tasks"/>
        </record>
        
	</data>
</openerp>