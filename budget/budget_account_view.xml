<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
    	
<menuitem id="budget_menu" name="Budget"/>
<menuitem id="budget_main_menu" name="Budget" parent="budget_menu"/>
    <!-- Year-->	
<record id="view_budget_year_form" model="ir.ui.view">
            <field name="name">budget.year.form</field>
            <field name="model">budget.year</field>
            <field name="arch" type="xml">
                <form string="Budget year" version="7.0">
	                <header>
	                    <button name="create_period" states="draft" string="Create Monthly Periods" type="object" class="oe_highlight"/>
	                    <button name="create_period3" states="draft" string="Create 3 Months Periods" type="object" class="oe_highlight"/>
	                    <field name="state" widget="statusbar" nolabel="1" />
	                </header>
	                <sheet>
	                	<h1>
	            			<label string=" Budget Year "/>	
	            		</h1>
	                    <group>
	                        <group>
	                            <field name="name"/>
	                            <field name="code"/>
	                            <field name="company_id" groups="base.group_multi_company"/>
	                        </group>
	                        <group>
	                            <field name="date_start"/>
	                            <field name="date_stop"/>
	                        </group>
	                    </group>
	                    <field colspan="4" name="period_ids" nolabel="1" widget="one2many_list">
	                        <form string="Period" version="7.0">
	                            <group col="4">
	                                <field name="name"/>
	                                <field name="code"/>
	                                <field name="date_start"/>
	                                <field name="date_stop"/>
	                                <field name="state" invisible="1"/>
	                            </group>
	                        </form>
	                    </field>
	            	</sheet>
                </form>
            </field>
        </record>
        <record id="view_budget_year_tree" model="ir.ui.view">
            <field name="name">budget.year.tree</field>
            <field name="model">budget.year</field>
            <field name="arch" type="xml">
                <tree colors="blue:state == 'draft';gray:state == 'done' " string="Fiscalyear">
                    <field name="code"/>
                    <field name="name"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        
 	<record id="view_budget_year_search" model="ir.ui.view">
            <field name="name">budget.year.search</field>
            <field name="model">budget.year</field>
            <field name="arch" type="xml">
                <search string="Search Budget year">
                    <field name="name" filter_domain="['|', ('name','ilike',self), ('code','ilike',self)]" string="Budget Year"/>
                    <filter string="Open" domain="[('state','=','draft')]" icon="terp-camera_test"/>
                    <filter string="Closed" domain="[('state','=','done')]" icon="terp-dialog-close"/>
                    <field name="state"/>
                    <group expand="0" string="Group By...">
                        <filter string="Status" context="{'group_by': 'state'}" icon="terp-stock_effects-object-colorize"/>
                    </group>
                </search>
            </field>
        </record>
       <record id="action_budget_year" model="ir.actions.act_window">
            <field name="name">Budget Years</field>
            <field name="res_model">budget.year</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to start a new budget year.
              </p><p>
                Define your company's Budget according to your needs. A
                budget year is a period at the end of which a company's
                accounts are made up (usually 12 months). The budget year is
                usually referred to by the date in which it ends. For example,
                if a company's budget year ends November 30, 2011, then
                everything between December 1, 2010 and November 30, 2011
                would be referred to as FY 2011.
              </p>
            </field>
        </record>
        <menuitem id="next_id_23" name="Periods" parent="budget_main_menu" sequence="5" />
        <menuitem id="menu_action_budget_year" action="action_budget_year" parent="budget.next_id_23"/>
        	
    	
      	<!-- Period -->

        <record id="view_budget_period_form" model="ir.ui.view">
            <field name="name">budget.period.form</field>
            <field name="model">budget.period</field>
            <field name="arch" type="xml">
                <form string="Budget Period" version="7.0">
                    <header>
                        <button name="action_draft" states="done" string="Re-Open Period" type="object" />
                        <field name="state" widget="statusbar" nolabel="1"/>
                    </header>
                    <sheet>
                    	<h1>
	            			<label string="Budget Period "/>	
	            		</h1>
                        <group>
                            <group>
                                <field name="name"/>
                                <field name="budgetyear_id" widget="selection"/>
                                <label for="date_start" string="Duration"/>
                                <div>
                                    <field name="date_start" class="oe_inline" nolabel="1"/> -
                                    <field name="date_stop" nolabel="1" class="oe_inline"/>
                                </div>
                            </group>
                            <group>
                                <field name="code"/>
                                <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        
        <record id="view_budget_period_tree" model="ir.ui.view">
            <field name="name">budget.period.tree</field>
            <field name="model">budget.period</field>
            <field name="arch" type="xml">
              <tree colors="blue:state == 'draft';gray:state == 'done' " string="Period">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="date_start"/>
                    <field name="date_stop"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        
        <record id="view_budget_period_search" model="ir.ui.view">
            <field name="name">budget.period.search</field>
            <field name="model">budget.period</field>
            <field name="arch" type="xml">
                <search string="Search Period">
                    <field name="name" filter_domain="['|', ('name','ilike',self), ('code','ilike',self)]" string="Period"/>
                    <filter string="To Close" name="draft" domain="[('state','=','draft')]" icon="terp-dialog-close"/>
                </search>
            </field>
        </record>
        <record id="action_budget_period" model="ir.actions.act_window">
            <field name="name">Periods</field>
            <field name="res_model">budget.period</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_draft': 1}</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a budget period.
              </p><p>
                An budget period typically is a month or a quarter.
              </p>
            </field>
        </record>
        <menuitem id="menu_action_budget_period" action="action_budget_period" parent="budget.next_id_23" groups="base.group_no_one"/>
        
       <!--Plan-->
       <record id="view_budget_plan_tree" model="ir.ui.view">
       	 <field name="name">budget.plan.tree</field>
            <field name="model">budget.plan</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
            	<tree string="Plans" colors="gray:state in ('closed','cancel');blue:state == 'confirmed';red:state =='draft'">
            		<field name="name"/>
            		<field name="year_id"/>
            		<field name="state"/>
            	</tree>
         	</field>
       </record> 

       <record id="view_budget_plan_form" model="ir.ui.view">
       	 <field name="name">budget.plan.form</field>
            <field name="model">budget.plan</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
            	<form string="Plans" version="7.0" >
            		<header>
        			    <button name="button_cancel" states="draft,confirmed" string="Cancel" />
        	            <button name="button_confirm" states="draft" string="Apply for approval" />
            	        <button name="button_approve" states="confirmed" string="Approve Plan" />
                	    <button name="button_close" states="approved" string="Close Plan"/>
                    	<button name="button_draft" states="confirmed" string="Back to draft"/>
                    	<button name="bulk_line_create" states="draft" string="Create lines from accounts" type="object" class="oe_highlight"/>
                    	<field name="state" widget="statusbar" statusbar_visible="draft,confirmed,approved,closed" statusbar_colors='{"closed":"gray","cancel":"gray","confirmed":"blue"}'/>
            		</header>
            		<sheet>
            			<h1>
            				<label string=" Budget Plan "/>	
            			</h1>
            			<group>
            				<field name="name"/>
            				<field name="year_id"/>
            				<field name="plan_lines"/>
            			</group>
            		</sheet>
                </form>
         </field>
       </record>    
       
		<record id="action_budget_plan" model="ir.actions.act_window">
            <field name="name">Budget Plans</field>
            <field name="res_model">budget.plan</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to start a new plan.
              </p><p>
                Define your company's Budget according to your needs. A
                budget plan allows you to distribute your resources into each budget entry 
              </p>
            </field>
        </record>    
        <menuitem id="next_id_24" name="Planning" parent="budget_main_menu" sequence="4"/>
        <menuitem action="action_budget_plan" id="budget_plan_menu" name="Budget Plans" parent="budget.next_id_24" />
        
       <!--Account-->        
       <record id="view_budget_account_tree" model="ir.ui.view">
            <field name="name">budget.account.tree</field>
            <field name="model">budget.account</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Budget accounts" colors="blue:account_type == 'view';green:account_type == 'institutional';black:account_type == 'budget';goldenrod:account_type =='consolidation'">
                    <field name="composite_code"/>
                    <field name="name"/>
                    <field name="account_type"/>
                </tree>
            </field>
        </record>

        <record id="view_budget_account_form" model="ir.ui.view">
            <field name="name">budget.account.form</field>
            <field name="model">budget.account</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
            	<form string="Budget Accounts" version="7.0">
            		<sheet>
	            		<h1>
	            			<label string=" Budget Account "/>	
	            		</h1>
	            		<group>
	            			<field name="code"/>
	            			<field name="composite_code"/>
	                		<field name="name"/>
	                		<field name="account_type" on_change="onchange_account_parent(account_type)"/>
	                		<field name="parent_id"/>
	                		<field name="child_consol_ids" domain="[('account_type','=','budget')]"
									attrs="{'invisible':[('account_type','!=','consolidation')]}"/>
	               		</group>
               		</sheet>
                </form>
            </field>
        </record>
        
        <record id="action_budget_account_tree" model="ir.actions.act_window">
            <field name="name">Budget Accounts</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">budget.account</field>
			<field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_budget_account_tree"/>
        </record>
        <menuitem action="action_budget_account_tree" id="budget_account_menu" name="Budget Accounts" parent="budget.next_id_24" />
        <menuitem id="budget_import_catalog_wizard_menu" name="Import account catalog from file" parent="budget_account_menu" action="action_budget_import_catalog"/>
        
<!--Plan Line-->
       <record id="view_budget_plan_line_tree" model="ir.ui.view">
       	 <field name="name">budget.plan.line.tree</field>
            <field name="model">budget.plan.line</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
            	<tree string="Plan lines">
            		<field name="name"/>
            		<field name="account_id"/>
            		<field name="plan_id"/>
            		<field name="assigned_ammount"/>
            	</tree>
         	</field>
       </record> 

       <record id="view_budget_plan_line_form" model="ir.ui.view">
       	 <field name="name">budget.plan.line.form</field>
            <field name="model">budget.plan.line</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
            	<form string="Plan lines" version="7.0" >

            		<sheet>
            			<h1>
            				<label string=" Budget Plan Line"/>	
            			</h1>
            			<group>
            				<field name="name"/>
            				<field name="account_id" domain="[('account_type','=','budget'), ('active','=','True')]"/>
            				<field name="plan_id"/>
            				<field name="assigned_ammount"/>
            				<field name="execution_percentage" readonly="True" widget="progressbar" />
            				<field name="available_budget"/>
            				<field name="available_cash"/>
            				<field name="sponsor_id"/>
            			</group>
            		</sheet>
                </form>
         </field>
       </record>    
       
		<record id="action_budget_plan_line" model="ir.actions.act_window">
            <field name="name">Budget Plan Lines</field>
            <field name="res_model">budget.plan.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to start a new plan line.
              </p><p>
                Define your company's Budget according to your needs. A
                budget plan allows you to distribute your resources into each budget entry 
              </p>
            </field>
        </record>    
        <menuitem action="action_budget_plan_line" id="budget_plan_line_menu" name="Budget Plan Lines" parent="budget.next_id_24" />
    </data>
</openerp>
